{"remainingRequest":"/Users/moritzmurauer/dev/ap/abschluss-pruefung/node_modules/babel-loader/lib/index.js!/Users/moritzmurauer/dev/ap/abschluss-pruefung/src/composables/getCollection.js","dependencies":[{"path":"/Users/moritzmurauer/dev/ap/abschluss-pruefung/src/composables/getCollection.js","mtime":1617292197953},{"path":"/Users/moritzmurauer/dev/ap/abschluss-pruefung/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/moritzmurauer/dev/ap/abschluss-pruefung/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL21vcml0em11cmF1ZXIvZGV2L2FwL2Fic2NobHVzcy1wcnVlZnVuZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL1VzZXJzL21vcml0em11cmF1ZXIvZGV2L2FwL2Fic2NobHVzcy1wcnVlZnVuZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwovL8OEaG5saWNoIHdpZSBUaHJpbGxzZWVrZXIgUHJvamVjdAppbXBvcnQgeyByZWYsIHdhdGNoRWZmZWN0IH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgcHJvamVjdEZpcmVzdG9yZSB9IGZyb20gJy4uL2ZpcmViYXNlL2NvbmZpZyc7Cgp2YXIgZ2V0Q29sbGVjdGlvbiA9IGZ1bmN0aW9uIGdldENvbGxlY3Rpb24oY29sbGVjdGlvbiwgcXVlcnkpIHsKICB2YXIgZG9jdW1lbnRzID0gcmVmKG51bGwpOwogIHZhciBlcnJvciA9IHJlZihudWxsKTsgLy8gU2F2aW5nIHNlbGVjdGVkIENvbGxlY3Rpb24gYW5kIHF1ZXJ5aW5nIHRocm91Z2ggaXQKCiAgdmFyIGNvbGxlY3Rpb25SZWYgPSBwcm9qZWN0RmlyZXN0b3JlLmNvbGxlY3Rpb24oY29sbGVjdGlvbik7CgogIGlmIChxdWVyeSkgewogICAgdmFyIF9jb2xsZWN0aW9uUmVmOwoKICAgIGNvbGxlY3Rpb25SZWYgPSAoX2NvbGxlY3Rpb25SZWYgPSBjb2xsZWN0aW9uUmVmKS53aGVyZS5hcHBseShfY29sbGVjdGlvblJlZiwgX3RvQ29uc3VtYWJsZUFycmF5KHF1ZXJ5KSk7CiAgfSAvLyBDcmVhdGluZyBSZWFsdGltZSBFdmVudGxpc3RlbmVyIHRvIHRyYWNrIGNoYW5nZXMgYnV0IGFsc28gdW5zdWJpbmcgaXQgYWZ0ZXIgYWN0aW9uIHNhdmUgY29zdHMgYW5kIG9wdGltaXplIHBlcmZvcm1hbmNlCgoKICB2YXIgdW5zdWIgPSBjb2xsZWN0aW9uUmVmLm9uU25hcHNob3QoZnVuY3Rpb24gKHNuYXApIHsKICAgIGNvbnNvbGUubG9nKCdzbmFwc2hvdCcpOwogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIHNuYXAuZG9jcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHsKICAgICAgLy9tdXN0IHdhaXQgZm9yIHRoZSBzZXJ2ZXIgdG8gY3JlYXRlIHRpbWVzdGFtcCBhbmQgc2VuZCBpdCBiYWNrCiAgICAgIHJlc3VsdHMucHVzaChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGRvYy5kYXRhKCkpLCB7fSwgewogICAgICAgIGlkOiBkb2MuaWQKICAgICAgfSkpOwogICAgfSk7IC8vdXBkYXRlIHZhbHVlcwoKICAgIGRvY3VtZW50cy52YWx1ZSA9IHJlc3VsdHM7CiAgICBlcnJvci52YWx1ZSA9IG51bGw7CiAgfSwgZnVuY3Rpb24gKGVycikgewogICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpOwogICAgZG9jdW1lbnRzLnZhbHVlID0gbnVsbDsKICAgIGVycm9yLnZhbHVlID0gJ2NvdWxkIG5vdCBmZXRjaCBkYXRhJzsKICB9KTsKICB3YXRjaEVmZmVjdChmdW5jdGlvbiAob25JbnZhbGlkYXRlKSB7CiAgICAvL3Vuc3ViIGZyb20gcHJldiBjb2xsZWN0aW9uCiAgICBvbkludmFsaWRhdGUoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdW5zdWIoKTsKICAgIH0pOwogIH0pOwogIHJldHVybiB7CiAgICBkb2N1bWVudHM6IGRvY3VtZW50cywKICAgIGVycm9yOiBlcnJvcgogIH07Cn07CgpleHBvcnQgZGVmYXVsdCBnZXRDb2xsZWN0aW9uOw=="},{"version":3,"sources":["/Users/moritzmurauer/dev/ap/abschluss-pruefung/src/composables/getCollection.js"],"names":["ref","watchEffect","projectFirestore","getCollection","collection","query","documents","error","collectionRef","where","unsub","onSnapshot","snap","console","log","results","docs","forEach","doc","push","data","id","value","err","message","onInvalidate"],"mappings":";;;;AAAA;AAEA,SAASA,GAAT,EAAcC,WAAd,QAAiC,KAAjC;AACA,SAASC,gBAAT,QAAiC,oBAAjC;;AAGA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,UAAD,EAAaC,KAAb,EAAuB;AAEzC,MAAMC,SAAS,GAAGN,GAAG,CAAC,IAAD,CAArB;AACA,MAAMO,KAAK,GAAGP,GAAG,CAAC,IAAD,CAAjB,CAHyC,CAMzC;;AACA,MAAIQ,aAAa,GAAGN,gBAAgB,CAACE,UAAjB,CAA4BA,UAA5B,CAApB;;AAEA,MAAGC,KAAH,EAAU;AAAA;;AACNG,IAAAA,aAAa,GAAG,kBAAAA,aAAa,EAACC,KAAd,0CAAuBJ,KAAvB,EAAhB;AACH,GAXwC,CAa3C;;;AACA,MAAMK,KAAK,GAAGF,aAAa,CAACG,UAAd,CAAyB,UAACC,IAAD,EAAU;AAC3CC,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACA,QAAIC,OAAO,GAAG,EAAd;AACAH,IAAAA,IAAI,CAACI,IAAL,CAAUC,OAAV,CAAkB,UAAAC,GAAG,EAAI;AAErB;AACAH,MAAAA,OAAO,CAACI,IAAR,iCAAiBD,GAAG,CAACE,IAAJ,EAAjB;AAA6BC,QAAAA,EAAE,EAAEH,GAAG,CAACG;AAArC;AACH,KAJD,EAH2C,CAS3C;;AACAf,IAAAA,SAAS,CAACgB,KAAV,GAAkBP,OAAlB;AACAR,IAAAA,KAAK,CAACe,KAAN,GAAc,IAAd;AACH,GAZW,EAYT,UAACC,GAAD,EAAS;AACRV,IAAAA,OAAO,CAACC,GAAR,CAAYS,GAAG,CAACC,OAAhB;AACAlB,IAAAA,SAAS,CAACgB,KAAV,GAAkB,IAAlB;AACAf,IAAAA,KAAK,CAACe,KAAN,GAAc,sBAAd;AACH,GAhBW,CAAd;AAkBErB,EAAAA,WAAW,CAAC,UAACwB,YAAD,EAAkB;AAC1B;AACAA,IAAAA,YAAY,CAAC;AAAA,aAAMf,KAAK,EAAX;AAAA,KAAD,CAAZ;AACH,GAHU,CAAX;AAKA,SAAO;AAACJ,IAAAA,SAAS,EAATA,SAAD;AAAYC,IAAAA,KAAK,EAALA;AAAZ,GAAP;AACH,CAtCD;;AAyCA,eAAeJ,aAAf","sourcesContent":["//Ã„hnlich wie Thrillseeker Project\n\nimport { ref, watchEffect } from 'vue';\nimport { projectFirestore } from '../firebase/config';\n\n\nconst getCollection = (collection, query) => {\n\n    const documents = ref(null)\n    const error = ref(null)\n\n\n    // Saving selected Collection and querying through it\n    let collectionRef = projectFirestore.collection(collection)\n\n    if(query) {\n        collectionRef = collectionRef.where(...query)\n    }\n \n  // Creating Realtime Eventlistener to track changes but also unsubing it after action save costs and optimize performance\n  const unsub = collectionRef.onSnapshot((snap) => {\n        console.log('snapshot');\n        let results = []\n        snap.docs.forEach(doc => {\n\n            //must wait for the server to create timestamp and send it back\n            results.push({...doc.data(), id: doc.id})\n        })\n\n        //update values\n        documents.value = results\n        error.value = null\n    }, (err) => {\n        console.log(err.message)\n        documents.value = null\n        error.value = 'could not fetch data'\n    })\n\n    watchEffect((onInvalidate) => {\n        //unsub from prev collection\n        onInvalidate(() => unsub())\n    })\n\n    return {documents, error}\n}\n\n\nexport default getCollection"]}]}